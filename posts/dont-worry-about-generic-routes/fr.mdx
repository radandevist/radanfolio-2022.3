---
title: Ne vous casser la tête avec des routes génériques dans vos API REST
cover: https://res.cloudinary.com/dhwkzyl32/image/upload/v1666628937/radanfolio/posts/dont-worry-about-generic-routes/cover_pexels_200_xdfoyx.jpg
date: 2022-07-30
topic: Rest API

excerpt: Traiter avec les API REST est un travail difficile, et dans cet article, je vais vous montrer pourquoi un itinéraire spécifique est parfois meilleur dans la conception de votre API.
featured: true
---

J'ai décidé de créer un clone de dev.to clone avec express and react.

L'un des problèmes auxquels je suis actuellement confronté est l'intégration des réponses de l'API REST servies par le back-end dans mon front-end.

Prenons comme exemple la page de profil d'un utilisateur dev.to. Pour le rendre, nous avons besoin, en plus des informations directes de l'utilisateur recherché, de ses derniers messages et commentaires.

![Décomposer l'interface utilisateur en différentes informations](https://res.cloudinary.com/dhwkzyl32/image/upload/v1666626423/radanfolio/posts/dont-worry-about-generic-routes/webpage-parts_jirtj7.jpg)

En gros, vous devez demander:

- Un utilisateur, qui contient lui-même:
  
  - plusieurs postes
  
  - plusieurs commentaires, dont chacun appartient à leurs propres messages respectifs

J'avais initialement imaginé un système de requêtes séquentielles en boucles for, mais après réflexion, je l'ai trouvé inapproprié car cela pouvait mettre en péril la viabilité de notre serveur back-end.


```typescript:manyRequests.ts
// ❌ Une très mauvaise idée
const user = get(`/api/user/${userId}`);
const posts = get(`/api/posts?userId=${userId}`);
const comments = get(`/api/comments?userId=${userID}`);

comments.forEach((element, index) => {
const commentPost = get(`/api/posts?id=${comment.postId}`);
comments[index].post = commentPost;
});
```

Une autre solution qui m'est venue à l'esprit est la mise en œuvre d'un parseur de requêtes inspiré de la façon dont ces populaires frameworks existants font pour populate les relations entre les entités. Et je suis tombé sur deux exemples en particulier pour m'inspirer:

- l'un est le farmework Loopback: [ici](https://loopback.io/doc/en/lb3/Relation-REST-API.html)

- et l'autre le CMS Strapi: [ici](https://docs.strapi.io/developer-docs/latest/developer-resources/database-apis-reference/rest/populating-fields.html#relation-media-fields)

Cependant, cela demande beaucoup de travail et cela en vaut-il vraiment la peine ?

![ça en vaut vraiment la peine?](https://media.giphy.com/media/Ll2fajzk9DgaY/giphy.gif)

Enfin, j'ai opté pour la mise en place d'un endpoint spécifiquement conçu pour la tâche: `GET /api/users/:username/profilepage` qui a l'avantage de nous satisfaire en un seul appel d'API et sans prise de tête supplémentaire.

Cet endpoint renverra une réponse de type:

```typescript:profilepage.ts
interface ProfilePage {
  id: string;
  username: string;
  firstname: string;
  lastname?: string;
  email: string;
  profile?: Profile;
  posts: PostElement[];
  comments: ProfilePageComment[];
}
```

Alors, pourquoi s'embêter avec des itinéraires génériques?
